package com.familug.gui;

import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.PixelFormat;
import android.os.IBinder;
import android.util.Log;
import android.view.Gravity;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.View.OnTouchListener;
import android.view.ViewGroup;
import android.view.WindowManager;
import android.widget.Toast;

public class HUD extends Service {
	HUDView mView;

	@Override
	public IBinder onBind(Intent intent) {
		return null;
	}

	@Override
	public void onCreate() {
		super.onCreate();
		Toast.makeText(getBaseContext(), "onCreate", Toast.LENGTH_LONG).show();
		mView = new HUDView(this);
		mView.setOnTouchListener(mView);
		mView.setOnClickListener(mView);
		
		// MyListener listener = new MyListener();
		// mView.setOnClickListener(listener);
		// mView.setOnTouchListener(listener);

		WindowManager.LayoutParams params = new WindowManager.LayoutParams(
				WindowManager.LayoutParams.TYPE_SYSTEM_OVERLAY,
				WindowManager.LayoutParams.FLAG_WATCH_OUTSIDE_TOUCH,
				PixelFormat.TRANSLUCENT);
		params.gravity = Gravity.RIGHT | Gravity.TOP;
		params.setTitle("Load Average");
		WindowManager wm = (WindowManager) getSystemService(WINDOW_SERVICE);
		wm.addView(mView, params);
	}

	@Override
	public void onDestroy() {
		super.onDestroy();
		Toast.makeText(getBaseContext(), "onDestroy", Toast.LENGTH_SHORT)
				.show();
		if (mView != null) {
			((WindowManager) getSystemService(WINDOW_SERVICE))
					.removeView(mView);
			mView = null;
		}
	}
}

class HUDView extends ViewGroup implements OnTouchListener, OnClickListener {
	private Paint mLoadPaint;

	public HUDView(Context context) {
		super(context);
		Toast.makeText(getContext(), "HUDView", Toast.LENGTH_SHORT).show();

		mLoadPaint = new Paint();
		mLoadPaint.setAntiAlias(true);
		mLoadPaint.setTextSize(10);
		mLoadPaint.setARGB(255, 255, 0, 0);
	}

//	@Override
//	protected void onDraw(Canvas canvas) {
//		super.onDraw(canvas);
//		canvas.drawText("APSTech", 135, 15, mLoadPaint);
//	}

	@Override
	protected void onLayout(boolean arg0, int arg1, int arg2, int arg3, int arg4) {
	}

	@Override
	public boolean onTouch(View v, MotionEvent event) {

		// ATTENTION: GET THE X,Y OF EVENT FROM THE PARAMETER
		// THEN CHECK IF THAT IS INSIDE YOUR DESIRED AREA
		Log.i("Coodinate", String.valueOf(event.getX() + ":" + event.getY()));
		Log.i("Motion:", String.valueOf(event.getActionMasked()) + "/"
				+ MotionEvent.ACTION_MOVE);
		if (event.getY() <= 0)// && event.getX() > 0)
		{
			switch (event.getAction()) {
			case MotionEvent.ACTION_MOVE:
				Log.d("Action move", "Moving");
				Toast.makeText(getContext(), "APSTech", Toast.LENGTH_LONG)
						.show();
				break;
			case MotionEvent.ACTION_DOWN:
				Log.d("Action down", "Downing");
				break;
			default:
				Log.d("Default", "Default");
				break;
			}
		}
		return true;
	}

	@Override
	public void onClick(View v) {
		// TODO Auto-generated method stub
		
	}
}
